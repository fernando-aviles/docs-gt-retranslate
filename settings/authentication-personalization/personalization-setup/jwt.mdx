---
title: 'JWT Handshake'
description: 'Use a customized login flow to authenticate users'
---

<Info>
  This is the documentation for the JWT **Personalization** Handshake. The steps for setting up the [JWT **Authentication** Handshake](/settings/authentication-personalization/authentication-setup/jwt) are slightly different.
</Info>

If you don't have a dashboard, or if you want to keep your dashboard and docs completely separate, you can use your own login flow to send user information to your docs via a JWT (JSON Web Token) in the URL.

## Implementation

<Steps>
  <Step title="Generate a private key">
    Go to your [Mintlify dashboard settings](https://dashboard.mintlify.com/products/authentication) and generate a private key. Store this key in a secure location where it can be accessed by your backend.
  </Step>
  <Step title="Create a login flow">
    Create a login flow that performs the following actions:
    - Authenticates the user
    - Creates a JWT containing the authenticated user's information in the [User](../sending-data) format
    - Signs the JWT with the secret key using the EdDSA algorithm
    - Creates a redirect URL back to your docs that includes the JWT as the hash parameter
  </Step>
  <Step title="Configure your Personalization settings">
    Return to your [Mintlify dashboard settings](https://dashboard.mintlify.com/products/authentication) and add the login URL to your Personalization settings.
  </Step>
</Steps>

## Example

In this example, we'll set up authentication for docs hosted at `docs.foo.com`. We want the docs to be completely separate from the dashboard (or we don't have a dashboard at all).

To set up authentication with Mintlify:

1. First, generate a JWT secret from the Mintlify dashboard
2. Create a web URL at `https://foo.com/docs-login` that initiates a login flow for your users
3. After verifying the user's identity at the end of the login flow, create a JWT containing the user's custom data according to Mintlify's specification
4. Use a JWT library to sign the JWT with your Mintlify secret
5. Create a redirect URL in the format `https://docs.foo.com#{SIGNED_JWT}`
6. Configure the login URL (`https://foo.com/docs-login`) in the Mintlify dashboard settings

Here's an example implementation:

```ts
import * as jose from 'jose';
import { Request, Response } from 'express';

const TWO_WEEKS_IN_MS = 1000 * 60 * 60 * 24 * 7 * 2;

const signingKey = await jose.importPKCS8(process.env.MINTLIFY_PRIVATE_KEY, 'EdDSA');

export async function handleRequest(req: Request, res: Response) {
  const user = {
    expiresAt: Math.floor((Date.now() + TWO_WEEKS_IN_MS) / 1000),
    groups: res.locals.user.groups,
    content: {
      firstName: res.locals.user.firstName,
      lastName: res.locals.user.lastName,
    },
  };

  const jwt = await new jose.SignJWT(user)
    .setProtectedHeader({ alg: 'EdDSA' })
    .setExpirationTime('10 s')
    .sign(signingKey);

  return res.redirect(`https://docs.foo.com#${jwt}`);
}
```

## Preserving Anchors

After login, you can preserve specific anchor locations on the page by using a special URL format that includes both the JWT and the anchor parameter: `https://docs.foo.com/page#jwt={SIGNED_JWT}&anchor={ANCHOR}`.

Examples:
- Original URL: `https://docs.foo.com/quickstart#step-one`
- Redirect URL with JWT: `https://docs.foo.com/quickstart#jwt={SIGNED_JWT}&anchor=step-one`